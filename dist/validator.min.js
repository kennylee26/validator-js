/**
 *
 * validator - 提供前端的验证工具
 *
 * @version v0.0.1
 * @license BSD-3-Clause
 * @author Kennylee
 *
 */
!function(e,t){"use strict";function r(e){this.options=a.clone(this.constructor.defaults),this.option(e)}var n=e,i=t,a={isObject:function(e){return e&&"object"==typeof e&&!this.isArray(e)},isElement:function(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}},getValue:function(e){if(this.isElement(e)){var t;return"input"===e.nodeName.toLowerCase()?t=e.value:"select"===e.nodeName.toLowerCase()&&(t=e.options[e.selectedIndex].value),t}},isArray:function(e){return Array.isArray(e)},isNotEmptyArray:function(e){return this.isArray(e)&&e.length>0},getInputs:function(e){var t=this.isElement(e)?e:i;return[].concat(Array.prototype.slice.call(t.getElementsByTagName("input"),0),Array.prototype.slice.call(t.getElementsByTagName("select"),0))},getElementsByName:function(e,t){if(i.getElementsByName&&this.isElement(t))return i.getElementsByName(e);var r=[],n=this.getInputs(t);if(this.isNotEmptyArray(n))for(var a=0,s=n.length;a!==s;a++){var o=n[a];o.getAttribute("name")===e&&r.push(o)}return r},getSingleElementByName:function(e,t){var r=this.getElementsByName(e,t);if(r&&r.length>0)return r[0]},clone:function(e){return this.mixin({},e)},mixin:function(e,t){var r=e||{};for(var n in t)t.hasOwnProperty(n)&&(this.isObject(t[n])?r[n]=this.mixin(r[n],t[n]):this.isArray(t[n])?r[n]=t[n].concat():r[n]=t[n]);return r},isString:function(e){return"string"==typeof e||e instanceof String},trim:function(e){return this.isString(e)?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""},strToJSON:function(e){var t={};if(e){e=a.trim(e),"{"!==e.substring(0,1)&&(e="{"+e+"}");try{t=new Function("return "+e)()}catch(t){alert("strToJSON failed! \n "+e)}}return t},stringFormat:function(e,t){if(this.isNotEmptyArray(t))for(var r=0;r!==t.length;r++){var n=new RegExp("\\{"+r+"\\}","gm");e=e.replace(n,t[r])}return e},getMatches:function(e,t,r){for(var n,i=void 0===r?1:r,a=[];n=t.exec(e);)a.push(n[i]);return a}},s=function(e){return!/^(([A-Z]*|[a-z]*|\d*|[-_\~!@#\$%\^&\*\.\(\)\[\]\{\}<>\?\\\/\'\"]*)|.{0,5})$|\s/.test(e)},o=function(e,t){e=e||"yyyy-MM-dd";var r=function(e,t,r,n,i){n=n||60,i=i||2;var a=r;return(void 0!==e&&""!==e||!isNaN(e))&&(a=1*e),void 0===t||""===t||isNaN(t)||(a=1*t),a===e&&e.length!==i||a>n?-1e4:a},n=this,i={},a=new Date,s=e.split(/[^a-z]+/gi),o=n.split(/\D+/g),u=e.split(/[a-z]+/gi),l=n.split(/\d+/g),c=s.length,y=u.length;if(c!==o.length||y!==l.length)return!1;for(var m=0;m<y;m++)if(u[m]!==l[m])return!1;for(m=0;m<c;m++)i[s[m]]=o[m];if(i.yyyy=r(i.yyyy,i.yy,a.getFullYear(),9999,4),i.MM=r(i.MM,i.M,a.getMonth()+1,12),i.dd=r(i.dd,i.d,a.getDate(),31),i.hh=r(i.hh,i.h,a.getHours(),24),i.mm=r(i.mm,i.m,a.getMinutes()),i.ss=r(i.ss,i.s,a.getSeconds()),i.ms=r(i.ms,i.ms,a.getMilliseconds(),999,3),i.yyyy+i.MM+i.dd+i.hh+i.mm+i.ss+i.ms<0)return!1;i.yyyy<100&&(i.yyyy+=i.yyyy>30?1900:2e3),a=new Date(i.yyyy,i.MM-1,i.dd,i.hh,i.mm,i.ss,i.ms);var g=a.getFullYear()===i.yyyy&&a.getMonth()+1===i.MM&&a.getDate()===i.dd&&a.getHours()===i.hh&&a.getMinutes()===i.mm&&a.getSeconds()===i.ss&&a.getMilliseconds()===i.ms;return g&&t?a:g},u=function(e){var t=e.getAttribute("data-validator-options");if(t)return a.strToJSON(t)},l=function(e){var t=/([^\[]+)(\[(.+)])?/g.exec(e);if(t){var r=[],n=t[3],i=[];if(n&&(i=n.split(",")),i.length>0)for(var a=0,s=i.length;a!==s;a++){var o=$.trim(i[a]),u=/"([^"]+)"/g.exec(e);u&&(o=u[1]),r.push(o)}return{name:t[1],params:r}}},c=function(e){if(18===e.length&&18!==e.length)return!1;var t,r=e.toLowerCase(),n=0,i="10x98765432",a=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=r.match(/^(\d{2})\d{4}(((\d{2})(\d{2})(\d{2})(\d{3}))|((\d{4})(\d{2})(\d{2})(\d{3}[x\d])))$/);if(null===s||"11,12,13,14,15,21,22,23,31,32,33,34,35,36,37,41,42,43,44,45,46,50,51,52,53,54,61,62,63,64,65,71,81,82,91".indexOf(s[1])<0)return!1;if(9===s[2].length?(r=r.substr(0,6)+"19"+r.substr(6),t=["19"+s[4],s[5],s[6]].join("-")):t=[s[9],s[10],s[11]].join("-"),!o.call(t,"yyyy-MM-dd"))return!1;for(var u=0;u<17;u++)n+=r.charAt(u)*a[u];return 9===s[2].length||r.charAt(17)===i.charAt(n%11)};r.defaults={message:{required:"该输入项为必输项!",zip:"邮政编码不存在!",loginName:"登录名称只允许英文字母、数字及下划线!",mobile:"手机号码格式不正确!",safePwd:"密码由字母和数字组成，至少6位!",length:"无效的输入项，请输入{0}-{1}的字符!",equalTo:"两次输入的密码不一致!",number:"请输入数字!",idCard:"请输入正确的身份证号码!",email:"无效的邮箱地址!"},validType:{required:{check:function(e){var t=a.trim(e);return!!(t&&t.length>0)}},zip:{check:function(e){return/^[1-9]\d{5}$/.test(e)}},mobile:{check:function(e){return/^((13[0-9])|(15[^4])|(18[0,2,3,5-9])|(17[0-8])|(147))\d{8}$/.test(e)}},loginName:{check:function(e){return/^[a-zA-Z0-9_]+$/.test(e)}},safePwd:{check:function(e,t){return s(e)}},length:{check:function(t,r){if(!r||isNaN(r[0])||isNaN(r[1]))return e.console&&console.log&&console.log("invalid params for length..."),!1;var n=$.trim(t);return n.length>=r[0]&&n.length<=r[1]}},equalTo:{check:function(t,r){if(!a.isNotEmptyArray(r))return e.console&&console.log&&console.log("param must be array..."),!1;var n,i=a.getElementsByName(r[0]);if(a.isNotEmptyArray(i)){var s=i[0];n=a.getValue(s)}return t===n}},number:{check:function(e){return/^\d+$/.test(e)}},idCard:{check:function(e){return c(e)}},email:{check:function(e){return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(e)}}}},a.mixin(r.prototype,{option:function(e){a.mixin(this.options,e)},getValidType:function(){return this.options.validType},checkForm:function(e){if(a.isElement(e)&&"form"===e.nodeName.toLowerCase()){var t=a.getInputs(e),r=[];if(a.isNotEmptyArray(t))for(var n=0,i=t.length;n!==i;n++){var s=t[n],o=s.getAttribute("name"),c=u(s),y=!(!c||!c.required||!0!==c.required&&"true"!==a.trim(c.required).toLowerCase()),m=void 0;if(y){var g=this.check(o,"required",e);g&&!g.isValid&&(m=g)}if(void 0===m&&c&&c.validType&&a.isNotEmptyArray(c.validType))for(var f=0,h=c.validType.length;f!==h;f++){var d=c.validType[f],p=l(d),v=this.check(o,p.name,e,p.params);if(v&&!v.isValid){v.invalidMessage=a.stringFormat(v.invalidMessage,p.params),m=v;break}}void 0!==m&&r.push({target:s,error:m})}return r}alert("only support form element.")},check:function(e,t,r,n){var i=this.getValidType()[t];if(!i)return void alert("invalid type name:  "+t+"\n input name: "+e);var s=a.getValue(a.getSingleElementByName(e,r)),o=i.check(s,n),u=this;return{isValid:o,invalidMessage:o?"":u.options.message[t]}}}),n.Validator=r}(window,document);